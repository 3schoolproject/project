<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>3-schooltest ‚Äî –∞–Ω–æ–Ω–∏–º–Ω—ã–π —Ç–µ—Å—Ç –ø–æ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</title>

  <style>
    :root{
      --bg:#0b1020;
      --card:#111a33;
      --text:#e9efff;
      --muted:#a9b6e8;
      --border:rgba(255,255,255,.10);
      --radius:18px;
      --shadow:0 18px 60px rgba(0,0,0,.45);

      /* neon */
      --neon:#00ff88;
      --neon2:#00d4ff;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,Segoe UI,Roboto,Arial;
      color:var(--text);
      min-height:100vh;
      padding:28px 14px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:
        radial-gradient(900px 500px at 10% 10%, rgba(106,168,255,.18), transparent 60%),
        radial-gradient(900px 500px at 90% 20%, rgba(123,255,182,.12), transparent 60%),
        radial-gradient(900px 500px at 50% 90%, rgba(255,106,139,.10), transparent 60%),
        linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
    }

    .app{width:min(1100px,100%); display:grid; gap:18px}

    header{
      display:flex; align-items:center; justify-content:space-between; gap:12px; padding:16px 18px;
      border:1px solid var(--border); border-radius:var(--radius);
      background:linear-gradient(180deg, rgba(17,26,51,.9), rgba(15,23,48,.85)); box-shadow:var(--shadow);
    }
    .brand{display:flex; align-items:center; gap:12px}
    .logo{
      width:42px;height:42px;border-radius:14px;
      background:linear-gradient(135deg, rgba(0,255,136,.65), rgba(0,212,255,.45));
      box-shadow:0 10px 30px rgba(0,255,136,.15);
    }
    .title h1{margin:0;font-size:18px}
    .title p{margin:2px 0 0;color:var(--muted);font-size:13px}
    .pill{
      border:1px solid rgba(0,255,136,.35);
      padding:8px 12px;
      border-radius:999px;
      color:rgba(0,255,136,.9);
      background:rgba(0,255,136,.05);
      font-size:13px;
      text-shadow:0 0 15px rgba(0,255,136,.25);
    }

    .card{
      border:1px solid var(--border);
      border-radius:var(--radius);
      background:linear-gradient(180deg, rgba(17,26,51,.92), rgba(15,23,48,.88));
      box-shadow:var(--shadow);
    }
    .card-inner{padding:18px}

    .grid2{display:grid; grid-template-columns:1.2fr .8fr; gap:18px}
    @media(max-width:860px){.grid2{grid-template-columns:1fr}}

    .h2{margin:0 0 8px 0; font-size:18px}
    .muted{color:var(--muted)}
    .small{font-size:13px; line-height:1.45}
    .note{
      padding:12px;
      border-radius:16px;
      border:1px dashed rgba(255,255,255,.18);
      color:var(--muted);
      background:rgba(255,255,255,.03);
      line-height:1.45;
      margin-top:10px;
    }

    .btns{display:flex; gap:10px; flex-wrap:wrap; margin-top:14px}
    button{
      border:1px solid var(--border);
      background:rgba(255,255,255,.05);
      color:var(--text);
      padding:10px 14px;
      border-radius:12px;
      cursor:pointer;
      font-weight:700;
      transition:.2s;
    }
    button:hover{transform:translateY(-1px); background:rgba(255,255,255,.08)}
    button.primary{
      border-color:rgba(0,255,136,.45);
      background:linear-gradient(135deg, rgba(0,255,136,.16), rgba(0,212,255,.10));
    }

    .progress-wrap{
      height:10px;
      background:rgba(255,255,255,.06);
      border:1px solid var(--border);
      border-radius:999px;
      overflow:hidden;
      margin-top:10px
    }
    .progress{
      height:100%;
      width:0%;
      background:linear-gradient(90deg, rgba(0,255,136,.9), rgba(0,212,255,.7));
      transition:.35s
    }

    /* ===== QUIZ UI ===== */
    .question{font-size:18px; margin:6px 0 12px; line-height:1.35}
    .choices{display:grid; gap:10px}
    .choice{
      padding:12px; border-radius:14px; border:1px solid var(--border);
      background:rgba(255,255,255,.04); cursor:pointer; transition:.2s;
      display:flex; gap:10px; align-items:flex-start;
    }
    .choice:hover{transform:translateY(-1px); background:rgba(255,255,255,.07)}
    .choice .tag{
      min-width:26px;height:26px;border-radius:9px;background:rgba(255,255,255,.06);
      display:flex;align-items:center;justify-content:center;color:var(--muted);
      font-weight:800;border:1px solid var(--border)
    }
    .choice.correct{border-color:rgba(123,255,182,.55); background:rgba(123,255,182,.10)}
    .choice.wrong{border-color:rgba(255,106,139,.55); background:rgba(255,106,139,.10)}
    .feedback{
      margin-top:14px; padding:12px; border-radius:14px; border:1px solid var(--border);
      background:rgba(255,255,255,.04); display:none;
    }
    .feedback.ok{border-color:rgba(123,255,182,.55); background:rgba(123,255,182,.10)}
    .feedback.bad{border-color:rgba(255,106,139,.55); background:rgba(255,106,139,.10)}
    .feedback h3{margin:0 0 6px; font-size:16px}
    .feedback p{margin:0; color:var(--muted)}

    .hidden{display:none!important}

    /* ====== STATS DESIGN (–∫–∞–∫ –Ω–∞ —Å–∫—Ä–∏–Ω–µ) ====== */
    .stats-title{
      text-align:center;
      font-size:2.2em;
      margin:10px 0 26px;
      text-transform:uppercase;
      letter-spacing:3px;
      color:var(--neon);
      text-shadow:0 0 20px rgba(0,255,136,.45);
    }

    .stats-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap:22px;
    }

    .chart-card{
      background: rgba(26, 31, 58, 0.80);
      border: 2px solid var(--neon);
      border-radius: 15px;
      padding: 26px;
      box-shadow: 0 0 30px rgba(0, 255, 136, 0.18);
      transition: all 0.25s ease;
      position: relative;
      overflow: hidden;
    }

    .chart-card::before{
      content:'';
      position:absolute;
      inset:-2px;
      background: linear-gradient(45deg, var(--neon), var(--neon2), #ff00ff, var(--neon));
      border-radius:15px;
      opacity:0;
      z-index:-1;
      transition: opacity 0.25s ease;
      animation: borderRotate 3s linear infinite;
    }
    .chart-card:hover::before{opacity:0.28}
    .chart-card:hover{transform:translateY(-4px); box-shadow:0 12px 45px rgba(0,255,136,.28)}

    @keyframes borderRotate { 0%{filter:hue-rotate(0deg)} 100%{filter:hue-rotate(360deg)} }

    .icon{
      text-align:center;
      font-size:2.4em;
      margin-bottom:12px;
      filter: drop-shadow(0 0 10px currentColor);
    }

    .chart-title{
      font-size:1.05em;
      margin-bottom:18px;
      text-align:center;
      color: var(--neon2);
      font-weight:700;
      line-height:1.35;
      min-height: 2.6em;
    }

    .chart-container{
      position: relative;
      width: 200px;
      height: 200px;
      margin: 0 auto 14px;
    }

    .circular-chart{ transform: rotate(-90deg); }

    .circle-bg{
      fill:none;
      stroke: rgba(0,255,136,0.12);
      stroke-width: 3.8;
    }

    .circle{
      fill:none;
      stroke-width:3.8;
      stroke-linecap:round;
      animation: progress 1.3s ease-out forwards;
    }
    @keyframes progress { 0% { stroke-dasharray: 0 100; } }

    .percentage{
      position:absolute;
      top:50%; left:50%;
      transform:translate(-50%,-50%);
      font-size:2.4em;
      font-weight:900;
      text-shadow:0 0 15px currentColor;
    }

    .description{
      text-align:center;
      color:#b8bcc8;
      font-size:0.95em;
      line-height:1.55;
    }

    /* –¶–≤–µ—Ç–∞ 6 –∫–∞—Ä—Ç–æ—á–µ–∫ */
    .chart-1 .circle { stroke: #ff3366; }
    .chart-1 .percentage, .chart-1 .icon { color: #ff3366; }

    .chart-2 .circle { stroke: #ffaa00; }
    .chart-2 .percentage, .chart-2 .icon { color: #ffaa00; }

    .chart-3 .circle { stroke: #ff6600; }
    .chart-3 .percentage, .chart-3 .icon { color: #ff6600; }

    .chart-4 .circle { stroke: #ff9900; }
    .chart-4 .percentage, .chart-4 .icon { color: #ff9900; }

    .chart-5 .circle { stroke: #ff0066; }
    .chart-5 .percentage, .chart-5 .icon { color: #ff0066; }

    .chart-6 .circle { stroke: #00d4ff; }
    .chart-6 .percentage, .chart-6 .icon { color: #00d4ff; }

    .stats-topnote{
      text-align:center;
      color: rgba(185, 196, 232, .92);
      margin: 0 0 18px;
      font-size: 13px;
      line-height: 1.45;
    }
  </style>
</head>

<body>
<div class="app">

  <header>
    <div class="brand">
      <div class="logo"></div>
      <div class="title">
        <h1>3-schooltest ‚Äî –∞–Ω–æ–Ω–∏–º–Ω—ã–π —Ç–µ—Å—Ç</h1>
        <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤—ã—Ö –∑–Ω–∞–Ω–∏–π –ø–æ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</p>
      </div>
    </div>
    <div class="pill" id="headerPill">–ì–æ—Ç–æ–≤(–∞) –Ω–∞—á–∞—Ç—å?</div>
  </header>

  <!-- WELCOME -->
  <section class="card" id="screenWelcome">
    <div class="card-inner grid2">
      <div>
        <h2 class="h2">–û–ø–∏—Å–∞–Ω–∏–µ</h2>
        <p class="muted small">
          –¢–µ—Å—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –±–∞–∑–æ–≤–æ–π –æ—Å–≤–µ–¥–æ–º–ª—ë–Ω–Ω–æ—Å—Ç–∏ –≤ –≤–æ–ø—Ä–æ—Å–∞—Ö –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
          –ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –∞–Ω–æ–Ω–∏–º–Ω–æ. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.
        </p>

        <div class="note">
          –§–æ—Ä–º–∞—Ç –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è: –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–≤–µ—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫—Ä–∞—Ç–∫–æ–µ –ø–æ—è—Å–Ω–µ–Ω–∏–µ –ø–æ —Ç–µ–º–µ, –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É.
        </div>

        <div class="btns">
          <button class="primary" id="btnStart">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç</button>
          <button id="btnGoStats">–û—Ç–∫—Ä—ã—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
        </div>
      </div>

      <div>
        <h2 class="h2">–£—Å–ª–æ–≤–∏—è</h2>
        <p class="muted small">
          ‚Ä¢ –ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞.<br/>
          ‚Ä¢ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.<br/>
          ‚Ä¢ –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª–∞–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
        </p>
        <div class="progress-wrap"><div class="progress" id="welcomeProg" style="width:0%"></div></div>
      </div>
    </div>
  </section>

  <!-- QUIZ -->
  <section class="card hidden" id="screenQuiz">
    <div class="card-inner">
      <div style="display:flex;justify-content:space-between;gap:12px;align-items:flex-end;flex-wrap:wrap">
        <div>
          <div class="muted small" id="qMeta">–í–æ–ø—Ä–æ—Å 1 –∏–∑ 6</div>
          <div class="question" id="qText">‚Ä¶</div>
        </div>
        <div style="min-width:240px;flex:1">
          <div class="muted small" style="display:flex;justify-content:space-between">
            <span>–ü—Ä–æ–≥—Ä–µ—Å—Å</span><span id="qProgressLabel">0%</span>
          </div>
          <div class="progress-wrap"><div class="progress" id="qProgress"></div></div>
        </div>
      </div>

      <div class="choices" id="choices"></div>

      <div class="feedback" id="feedback">
        <h3 id="fbTitle">‚Ä¶</h3>
        <p id="fbText">‚Ä¶</p>
        <div class="btns">
          <button class="primary" id="btnNext">–î–∞–ª–µ–µ</button>
        </div>
      </div>
    </div>
  </section>

  <!-- STATS (NEON DESIGN) -->
  <section class="card hidden" id="screenStats">
    <div class="card-inner">

      <div class="stats-title">üîí –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ üîí</div>
      <p class="stats-topnote" id="resultLine">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏‚Ä¶</p>

      <div class="stats-grid" id="statsCards">
        <!-- cards are generated by JS -->
      </div>

      <div class="btns" style="justify-content:center; margin-top:18px">
        <button id="btnBackHome">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
      </div>
    </div>
  </section>

</div>

<!-- Firebase CDN -->
<script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore-compat.js"></script>

<script>
  /* ===== Firebase init ===== */
  const firebaseConfig = {
    apiKey: "AIzaSyC8YASgWFP-uOeawkCbT-eQRJJ38QnU5hA",
    authDomain: "cybersecurity-test-89935.firebaseapp.com",
    projectId: "cybersecurity-test-89935",
    storageBucket: "cybersecurity-test-89935.firebasestorage.app",
    messagingSenderId: "738081122573",
    appId: "1:738081122573:web:86e74e202eac34a2cb2844"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();
  const SUBMISSIONS = db.collection("submissions");

  let currentUid = null;

  /* ===== Questions (6 —à—Ç) ===== */
  const QUESTIONS = [
    {
      q:"–ö–∞–∫–æ–π –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –Ω–∞–∏–±–æ–ª–µ–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç –ø—Ä–∞–∫—Ç–∏–∫—É –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π?",
      a:[
        "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤",
        "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–π –ø–∞—Ä–æ–ª—å, –Ω–æ —á–∞—Å—Ç–æ –º–µ–Ω—è—Ç—å",
        "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞",
        "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è –∏–ª–∏ –∏–º—è"
      ],
      correct:2,
      explain:"–ù–∞–¥—ë–∂–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ ‚Äî –¥–ª–∏–Ω–Ω—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞. –≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ —Ü–µ–ø–Ω–æ–≥–æ –≤–∑–ª–æ–º–∞ –ø—Ä–∏ —É—Ç–µ—á–∫–µ –Ω–∞ –æ–¥–Ω–æ–º —Å–∞–π—Ç–µ."
    },
    {
      q:"–î–ª—è —á–µ–≥–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (2FA)?",
      a:[
        "–î–ª—è —Å–∫—Ä—ã—Ç–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞",
        "–î–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—Ö–æ–¥–∞ –≤—Ç–æ—Ä—ã–º –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º —Ñ–∞–∫—Ç–æ—Ä–æ–º (–∫–æ–¥/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)",
        "–î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞",
        "–î–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ä–µ–∫–ª–∞–º—ã"
      ],
      correct:1,
      explain:"2FA –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—Ç–æ—Ä–æ–π —Ñ–∞–∫—Ç–æ—Ä –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è. –î–∞–∂–µ –µ—Å–ª–∏ –ø–∞—Ä–æ–ª—å —É–∫—Ä–∞–¥—É—Ç, –±–µ–∑ –≤—Ç–æ—Ä–æ–≥–æ —à–∞–≥–∞ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É —Å–ª–æ–∂–Ω–µ–µ –≤–æ–π—Ç–∏."
    },
    {
      q:"–ö–∞–∫ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å—Å—ã–ª–∫–æ–π ¬´—Å—Ä–æ—á–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å¬ª?",
      a:[
        "–ü–µ—Ä–µ–π—Ç–∏ –ø–æ —Å—Å—ã–ª–∫–µ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è",
        "–û—Ç–∫—Ä—ã—Ç—å —Å–µ—Ä–≤–∏—Å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–º",
        "–ü–µ—Ä–µ—Å–ª–∞—Ç—å —Å—Å—ã–ª–∫—É –∑–Ω–∞–∫–æ–º—ã–º",
        "–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª—é–±—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
      ],
      correct:1,
      explain:"–ë–µ–∑–æ–ø–∞—Å–Ω–µ–µ –∑–∞–π—Ç–∏ –≤ —Å–µ—Ä–≤–∏—Å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –°—Å—ã–ª–∫–∏ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö —á–∞—Å—Ç–æ –≤–µ–¥—É—Ç –Ω–∞ –ø–æ–¥–¥–µ–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã."
    },
    {
      q:"–ü–æ—á–µ–º—É –æ–ø–∞—Å–Ω–æ —Å–∫–∞—á–∏–≤–∞—Ç—å —Ñ–∞–π–ª—ã/–ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–∑ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤?",
      a:[
        "–û–Ω–∏ –≤—Å–µ–≥–¥–∞ –ø–ª–∞—Ç–Ω—ã–µ",
        "–û–Ω–∏ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫—Ä–∞–∂—É –ø–∞—Ä–æ–ª–µ–π)",
        "–û–Ω–∏ –∑–∞–Ω–∏–º–∞—é—Ç –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏",
        "–û–Ω–∏ —Ö—É–∂–µ —Ä–∞–±–æ—Ç–∞—é—Ç"
      ],
      correct:1,
      explain:"–ù–µ–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û. –≠—Ç–æ —á–∞—Å—Ç—ã–π —Å–ø–æ—Å–æ–± –∑–∞—Ä–∞–∂–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞."
    },
    {
      q:"–ß—Ç–æ –Ω–∞–∏–±–æ–ª–µ–µ —Ç–æ—á–Ω–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∏—à–∏–Ω–≥?",
      a:[
        "–ú–µ—Ç–æ–¥ –∑–∞—â–∏—Ç—ã –æ—Ç –≤–∏—Ä—É—Å–æ–≤",
        "–ü–æ–¥–¥–µ–ª—å–Ω—ã–µ —Å–∞–π—Ç—ã/—Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∫—Ä–∞–∂–∏ –ª–æ–≥–∏–Ω–æ–≤, –ø–∞—Ä–æ–ª–µ–π –∏–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç—ã",
        "–§—É–Ω–∫—Ü–∏—è —É—Å–∫–æ—Ä–µ–Ω–∏—è Wi-Fi",
        "–†–µ–∫–ª–∞–º–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ –±–µ–∑ –≤—Ä–µ–¥–∞"
      ],
      correct:1,
      explain:"–§–∏—à–∏–Ω–≥ ‚Äî —ç—Ç–æ –ø–æ–¥–º–µ–Ω–∞ —Å–∞–π—Ç–∞/—Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–¥ ¬´–Ω–∞—Å—Ç–æ—è—â–∏–π¬ª —Å–µ—Ä–≤–∏—Å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–æ–ª—å, –∫–æ–¥ –∏–ª–∏ –ø–ª–∞—Ç—ë–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ."
    },
    {
      q:"–ß—Ç–æ —Å–ª–µ–¥—É–µ—Ç —Å–¥–µ–ª–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –≤–∑–ª–æ–º –∞–∫–∫–∞—É–Ω—Ç–∞?",
      a:[
        "–£–¥–∞–ª–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",
        "–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å, –∑–∞–≤–µ—Ä—à–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –∏ –≤–∫–ª—é—á–∏—Ç—å 2FA",
        "–ù–∞–ø–∏—Å–∞—Ç—å –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É",
        "–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç –∏ –∑–∞–±—ã—Ç—å"
      ],
      correct:1,
      explain:"–°–Ω–∞—á–∞–ª–∞ –∑–∞–∫—Ä—ã–≤–∞—é—Ç –¥–æ—Å—Ç—É–ø: —Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è, –≤—ã—Ö–æ–¥ –∏–∑ —Å–µ—Å—Å–∏–π, –≤–∫–ª—é—á–µ–Ω–∏–µ 2FA. –≠—Ç–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç –¥–∞–ª—å–Ω–µ–π—à–∏–π —É—â–µ—Ä–±."
    }
  ];

  // –ò–∫–æ–Ω–∫–∏ –∏ ‚Äú–ø–æ–¥–ø–∏—Å–∏‚Äù –ø–æ–¥ –∫–∞—Ä—Ç–æ—á–∫–∏ (–∫–∞–∫ –≤ —Ç–≤–æ—ë–º –ø—Ä–∏–º–µ—Ä–µ)
  const STAT_META = [
    { icon:"üîë", desc:"–ù–∏–∑–∫–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —É—Ç–µ—á–∫–∞–º: –ø—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –ø–æ–≤—ã—à–∞–µ—Ç—Å—è —Ä–∏—Å–∫ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥—Ä—É–≥–∏–º –∞–∫–∫–∞—É–Ω—Ç–∞–º." },
    { icon:"üõ°Ô∏è", desc:"–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ 2FA —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—Ö–æ–¥ –ø—Ä–∏ —É—Ç–µ—á–∫–µ –∏–ª–∏ –ø–æ–¥–±–æ—Ä–µ –ø–∞—Ä–æ–ª—è." },
    { icon:"üé£", desc:"–ü–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å–æ–º–Ω–∏—Ç–µ–ª—å–Ω—ã–º —Å—Å—ã–ª–∫–∞–º –ø–æ–≤—ã—à–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ñ–∏—à–∏–Ω–≥–∞ –∏ –∑–∞—Ä–∞–∂–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞." },
    { icon:"üì•", desc:"–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏–∑ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ ‚Äî —á–∞—Å—Ç—ã–π –ø—É—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û." },
    { icon:"‚ùì", desc:"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ñ–∏—à–∏–Ω–≥–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å—Ç–∞—Ç—å –∂–µ—Ä—Ç–≤–æ–π –ø–æ–¥–¥–µ–ª—å–Ω—ã—Ö —Å–∞–π—Ç–æ–≤ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π." },
    { icon:"‚ö†Ô∏è", desc:"–ü–æ–ø—ã—Ç–∫–∏ –≤–∑–ª–æ–º–∞ ‚Äî —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–π —Ä–∏—Å–∫; –±–∞–∑–æ–≤—ã–µ –º–µ—Ä—ã –∑–∞—â–∏—Ç—ã –∑–∞–º–µ—Ç–Ω–æ —Å–Ω–∏–∂–∞—é—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—Ö–∞ –∞—Ç–∞–∫–∏." }
  ];

  /* ===== UI refs ===== */
  const screenWelcome = document.getElementById("screenWelcome");
  const screenQuiz = document.getElementById("screenQuiz");
  const screenStats = document.getElementById("screenStats");
  const headerPill = document.getElementById("headerPill");

  const btnStart = document.getElementById("btnStart");
  const btnGoStats = document.getElementById("btnGoStats");
  const btnBackHome = document.getElementById("btnBackHome");

  const qMeta = document.getElementById("qMeta");
  const qText = document.getElementById("qText");
  const choices = document.getElementById("choices");

  const feedback = document.getElementById("feedback");
  const fbTitle = document.getElementById("fbTitle");
  const fbText = document.getElementById("fbText");
  const btnNext = document.getElementById("btnNext");

  const qProgress = document.getElementById("qProgress");
  const qProgressLabel = document.getElementById("qProgressLabel");

  const resultLine = document.getElementById("resultLine");
  const statsCards = document.getElementById("statsCards");

  /* ===== Helpers ===== */
  function show(screen){
    screenWelcome.classList.add("hidden");
    screenQuiz.classList.add("hidden");
    screenStats.classList.add("hidden");
    screen.classList.remove("hidden");
  }
  function updateHeader(){
    if(!screenQuiz.classList.contains("hidden")){
      headerPill.textContent = `–í–æ–ø—Ä–æ—Å ${idx+1}/${QUESTIONS.length}`;
    } else if(!screenStats.classList.contains("hidden")){
      headerPill.textContent = "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞";
    } else {
      headerPill.textContent = "–ì–æ—Ç–æ–≤(–∞) –Ω–∞—á–∞—Ç—å?";
    }
  }
  async function ensureAuth(){
    if(auth.currentUser){
      currentUid = auth.currentUser.uid;
      return currentUid;
    }
    const res = await auth.signInAnonymously();
    currentUid = res.user.uid;
    return currentUid;
  }
  async function hasAlreadySubmitted(uid){
    const doc = await SUBMISSIONS.doc(uid).get();
    return doc.exists;
  }

  /* ===== Quiz state ===== */
  let idx = 0;
  let score = 0;
  let answered = false;
  let userAnswersCorrect = Array(QUESTIONS.length).fill(false);

  function renderQuestion(){
    answered = false;
    feedback.style.display = "none";
    choices.innerHTML = "";

    const item = QUESTIONS[idx];
    qMeta.textContent = `–í–æ–ø—Ä–æ—Å ${idx+1} –∏–∑ ${QUESTIONS.length}`;
    qText.textContent = item.q;

    const pct = Math.round((idx / QUESTIONS.length) * 100);
    qProgress.style.width = pct + "%";
    qProgressLabel.textContent = pct + "%";

    item.a.forEach((text, i) => {
      const btn = document.createElement("div");
      btn.className = "choice";
      btn.innerHTML = `<div class="tag">${String.fromCharCode(65+i)}</div><div>${text}</div>`;
      btn.addEventListener("click", () => pick(i));
      choices.appendChild(btn);
    });

    updateHeader();
  }

  function pick(choiceIndex){
    if(answered) return;
    answered = true;

    const item = QUESTIONS[idx];
    const isCorrect = choiceIndex === item.correct;
    userAnswersCorrect[idx] = isCorrect;

    const all = Array.from(document.querySelectorAll(".choice"));
    all.forEach((el, i) => {
      if(i === item.correct) el.classList.add("correct");
      if(i === choiceIndex && !isCorrect) el.classList.add("wrong");
      el.style.pointerEvents = "none";
    });

    if(isCorrect){
      score += 1;
      fbTitle.textContent = "–í–µ—Ä–Ω–æ";
      feedback.className = "feedback ok";
    } else {
      fbTitle.textContent = "–ù–µ–≤–µ—Ä–Ω–æ";
      feedback.className = "feedback bad";
    }

    fbText.textContent = item.explain;
    feedback.style.display = "block";
  }

  async function submitResult(){
    await SUBMISSIONS.doc(currentUid).set({
      createdAt: firebase.firestore.FieldValue.serverTimestamp(),
      score,
      total: QUESTIONS.length,
      answersCorrect: userAnswersCorrect
    });
  }

  function buildCircleCard(i, rate){
    const meta = STAT_META[i] || { icon:"üîí", desc:"" };
    const dash = `${rate}, 100`;

    const card = document.createElement("div");
    card.className = `chart-card chart-${i+1}`;
    card.innerHTML = `
      <div class="icon">${meta.icon}</div>
      <div class="chart-title">${QUESTIONS[i].q}</div>
      <div class="chart-container">
        <svg viewBox="0 0 36 36" class="circular-chart">
          <path class="circle-bg"
            d="M18 2.0845
               a 15.9155 15.9155 0 0 1 0 31.831
               a 15.9155 15.9155 0 0 1 0 -31.831" />
          <path class="circle"
            stroke-dasharray="${dash}"
            d="M18 2.0845
               a 15.9155 15.9155 0 0 1 0 31.831
               a 15.9155 15.9155 0 0 1 0 -31.831" />
        </svg>
        <div class="percentage">${rate}%</div>
      </div>
      <div class="description">${meta.desc}</div>
    `;
    return card;
  }

  /* ===== Global stats: —Å—á–∏—Ç–∞–µ–º –∏–∑ –≤—Å–µ—Ö submissions ===== */
  async function renderGlobalStats(lastScore=null){
    statsCards.innerHTML = "";
    resultLine.textContent = "–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏‚Ä¶";

    const snap = await SUBMISSIONS.get();
    const n = QUESTIONS.length;

    let attempts = 0;
    let totalScore = 0;
    let bestScore = 0;
    let qTotal = Array(n).fill(0);
    let qCorrect = Array(n).fill(0);

    snap.forEach(doc => {
      const d = doc.data();
      if(!d || !Array.isArray(d.answersCorrect)) return;

      attempts += 1;
      totalScore += (d.score || 0);
      bestScore = Math.max(bestScore, (d.score || 0));

      for(let i=0;i<n;i++){
        qTotal[i] += 1;
        if(d.answersCorrect[i]) qCorrect[i] += 1;
      }
    });

    const avg = attempts ? (totalScore / attempts) : 0;
    const avgPct = Math.round((avg/n)*100);

    resultLine.textContent =
      lastScore === null
        ? `–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: ${attempts}. –°—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${avgPct}%. –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${bestScore}/${n}.`
        : `–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${lastScore}/${n}. –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: ${attempts}. –°—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${avgPct}%.`;

    for(let i=0;i<n;i++){
      const t = qTotal[i];
      const c = qCorrect[i];
      const rate = t ? Math.round((c/t)*100) : 0;
      statsCards.appendChild(buildCircleCard(i, rate));
    }
  }

  /* ===== Buttons ===== */
  btnStart.addEventListener("click", async () => {
    await ensureAuth();
    if(await hasAlreadySubmitted(currentUid)){
      alert("–¢–µ—Å—Ç —É–∂–µ –ø—Ä–æ–π–¥–µ–Ω. –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ.");
      return;
    }
    idx = 0;
    score = 0;
    userAnswersCorrect = Array(QUESTIONS.length).fill(false);
    show(screenQuiz);
    renderQuestion();
  });

  btnNext.addEventListener("click", async () => {
    if(!answered) return;
    idx += 1;
    if(idx >= QUESTIONS.length){
      await submitResult();
      await renderGlobalStats(score);
      show(screenStats);
      updateHeader();
    } else {
      renderQuestion();
    }
  });

  btnGoStats.addEventListener("click", async () => {
    await ensureAuth();
    await renderGlobalStats(null);
    show(screenStats);
    updateHeader();
  });

  btnBackHome.addEventListener("click", () => {
    show(screenWelcome);
    updateHeader();
  });

  updateHeader();
</script>
</body>
</html>
